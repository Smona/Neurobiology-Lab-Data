// Platform=Macintosh, IGORVersion=6.340, architecture=Intel, systemTextEncoding="macintosh", historyTextEncoding="macintosh", procwinTextEncoding="macintosh"Silent 101 // use | as bitwise or -- not comment.NewPath home ":March2-Module2 Folder:"NewPath student_macros ":::igor procs:student_macros:"NewPath igor_procs ":::igor procs:"ReadVariablesLoadWave/C /P=home "Colors.ibw"LoadWave/C /P=home "dacgain.ibw"LoadWave/C /P=home "adcgain.ibw"LoadWave/C /P=home "adcname.ibw"LoadWave/C /P=home "ttlon.ibw"LoadWave/C /P=home "dacon.ibw"LoadWave/C /P=home "adcon.ibw"LoadWave/C /P=home "roiwave.ibw"LoadWave/C /P=home "roibox_y.ibw"LoadWave/C /P=home "roibox_x.ibw"LoadWave/C /P=home "roibox_y2.ibw"LoadWave/C /P=home "roibox_x2.ibw"LoadWave/C /P=home "roibox_y1.ibw"LoadWave/C /P=home "roibox_x1.ibw"LoadWave/C /P=home "DACwave.ibw"LoadWave/C /P=home "FIFOout.ibw"LoadWave/C /P=home "FIFOin.ibw"LoadWave/C /P=home "ADCwave.ibw"LoadWave/C /P=home "TestPulse_DAC.ibw"LoadWave/C /P=home "TestPulse_ADC.ibw"LoadWave/C /P=home "StepPulse_DAC.ibw"LoadWave/C /P=home "StepPulse_ADC.ibw"LoadWave/C /P=home "SynPulse_TTL.ibw"LoadWave/C /P=home "NewDAC.ibw"LoadWave/C /P=home "SineDAC.ibw"LoadWave/C /P=home "PSCDAC.ibw"LoadWave/C /P=home "RampDAC.ibw"LoadWave/C /P=home "TrainDAC.ibw"LoadWave/C /P=home "Step5DAC.ibw"LoadWave/C /P=home "duration.ibw"LoadWave/C /P=home "amplitude.ibw"LoadWave/C /P=home "dff_avg.ibw"LoadWave/C /P=home "IVStep_DAC.ibw"LoadWave/C /P=home "TestTrig_TTL.ibw"LoadWave/C /P=home "ad0_1.bwav"LoadWave/C /P=home "ad1_2.bwav"LoadWave/C /P=home "ad1_3.bwav"LoadWave/C /P=home "threshold_DAC.ibw"LoadWave/C /P=home "threshold100_DAC.ibw"LoadWave/C /P=home "ad1_4.bwav"LoadWave/C /P=home "ad1_5.bwav"LoadWave/C /P=home "ad1_6.bwav"LoadWave/C /P=home "ad1_7.bwav"LoadWave/C /P=home "ad1_8.bwav"LoadWave/C /P=home "ad1_9.bwav"LoadWave/C /P=home "ad1_10.bwav"LoadWave/C /P=home "ad1_11.bwav"LoadWave/C /P=home "ad1_12.bwav"LoadWave/C /P=home "ad1_13.bwav"LoadWave/C /P=home "ad1_14.bwav"LoadWave/C /P=home "ad1_15.bwav"LoadWave/C /P=home "ad1_16.bwav"LoadWave/C /P=home "ad1_17.bwav"LoadWave/C /P=home "ad1_18.bwav"LoadWave/C /P=home "ad1_19.bwav"LoadWave/C /P=home "ad1_20.bwav"LoadWave/C /P=home "ad1_21.bwav"LoadWave/C /P=home "ad1_22.bwav"LoadWave/C /P=home "ad1_23.bwav"LoadWave/C /P=home "ad1_24.bwav"LoadWave/C /P=home "ad1_25.bwav"LoadWave/C /P=home "ad1_26.bwav"LoadWave/C /P=home "ad1_27.bwav"LoadWave/C /P=home "ad1_28.bwav"LoadWave/C /P=home "TwoPulse_DAC.ibw"LoadWave/C /P=home "ad1_29.bwav"LoadWave/C /P=home "ad1_30.bwav"LoadWave/C /P=home "ad1_31.bwav"LoadWave/C /P=home "ad1_32.bwav"LoadWave/C /P=home "ad1_33.bwav"LoadWave/C /P=home "ad1_34.bwav"LoadWave/C /P=home "ad1_35.bwav"LoadWave/C /P=home "ad1_36.bwav"LoadWave/C /P=home "ad1_37.bwav"LoadWave/C /P=home "ad1_38.bwav"LoadWave/C /P=home "ad1_39.bwav"LoadWave/C /P=home "ad1_40.bwav"LoadWave/C /P=home "ad1_41.bwav"LoadWave/C /P=home "ad1_42.bwav"LoadWave/C /P=home "ad1_43.bwav"LoadWave/C /P=home "ad1_44.bwav"LoadWave/C /P=home "ad1_45.bwav"LoadWave/C /P=home "ad1_46.bwav"LoadWave/C /P=home "ad1_47.bwav"LoadWave/C /P=home "ad1_48.bwav"LoadWave/C /P=home "ad1_49.bwav"LoadWave/C /P=home "ad1_50.bwav"LoadWave/C /P=home "ad1_51.bwav"LoadWave/C /P=home "ad1_52.bwav"LoadWave/C /P=home "ad1_53.bwav"LoadWave/C /P=home "ad1_54.bwav"LoadWave/C /P=home "ad1_55.bwav"LoadWave/C /P=home "ad1_56.bwav"LoadWave/C /P=home "ad1_57.bwav"LoadWave/C /P=home "ad1_58.bwav"LoadWave/C /P=home "ad1_59.bwav"LoadWave/C /P=home "ad1_60.bwav"LoadWave/C /P=home "ad1_61.bwav"LoadWave/C /P=home "ad1_62.bwav"LoadWave/C /P=home "ad1_63.bwav"LoadWave/C /P=home "ad1_64.bwav"LoadWave/C /P=home "ad1_65.bwav"LoadWave/C /P=home "ad1_66.bwav"LoadWave/C /P=home "ad1_67.bwav"LoadWave/C /P=home "ad1_68.bwav"LoadWave/C /P=home "ad1_69.bwav"LoadWave/C /P=home "ad1_70.bwav"LoadWave/C /P=home "ad1_71.bwav"LoadWave/C /P=home "ad1_72.bwav"LoadWave/C /P=home "ad1_73.bwav"LoadWave/C /P=home "ad1_74.bwav"LoadWave/C /P=home "ad1_75.bwav"LoadWave/C /P=home "ad1_76.bwav"LoadWave/C /P=home "ad1_77.bwav"LoadWave/C /P=home "ad1_78.bwav"LoadWave/C /P=home "ad1_79.bwav"LoadWave/C /P=home "ad1_80.bwav"LoadWave/C /P=home "ad1_81.bwav"LoadWave/C /P=home "ad1_82.bwav"LoadWave/C /P=home "ad1_83.bwav"LoadWave/C /P=home "ad1_84.bwav"LoadWave/C /P=home "ad1_85.bwav"LoadWave/C /P=home "ad1_86.bwav"LoadWave/C /P=home "ad1_87.bwav"LoadWave/C /P=home "ad1_88.bwav"LoadWave/C /P=home "ad1_89.bwav"LoadWave/C /P=home "ad1_90.bwav"LoadWave/C /P=home "ad1_91.bwav"LoadWave/C /P=home "ad1_92.bwav"LoadWave/C /P=home "ad1_93.bwav"LoadWave/C /P=home "ad1_94.bwav"LoadWave/C /P=home "ad1_95.bwav"LoadWave/C /P=home "ad1_96.bwav"LoadWave/C /P=home "ad1_97.bwav"LoadWave/C /P=home "ad1_98.bwav"LoadWave/C /P=home "ad1_99.bwav"LoadWave/C /P=home "ad1_100.bwav"LoadWave/C /P=home "ad1_101.bwav"LoadWave/C /P=home "ad1_102.bwav"LoadWave/C /P=home "ad1_103.bwav"LoadWave/C /P=home "ad1_104.bwav"LoadWave/C /P=home "ad1_105.bwav"LoadWave/C /P=home "ad1_106.bwav"LoadWave/C /P=home "ad1_107.bwav"LoadWave/C /P=home "ad1_108.bwav"LoadWave/C /P=home "ad1_109.bwav"LoadWave/C /P=home "ad1_110.bwav"LoadWave/C /P=home "ad1_111.bwav"LoadWave/C /P=home "ad1_112.bwav"LoadWave/C /P=home "ad1_113.bwav"LoadWave/C /P=home "ad1_114.bwav"LoadWave/C /P=home "ad1_115.bwav"LoadWave/C /P=home "ad1_116.bwav"LoadWave/C /P=home "ad1_117.bwav"LoadWave/C /P=home "ad1_118.bwav"LoadWave/C /P=home "ad1_119.bwav"LoadWave/C /P=home "ad1_120.bwav"LoadWave/C /P=home "ad1_121.bwav"LoadWave/C /P=home "ad1_122.bwav"LoadWave/C /P=home "ad1_123.bwav"LoadWave/C /P=home "ad1_124.bwav"LoadWave/C /P=home "ad1_125.bwav"LoadWave/C /P=home "ad1_126.bwav"LoadWave/C /P=home "ad1_127.bwav"LoadWave/C /P=home "ad1_128.bwav"LoadWave/C /P=home "ad1_129.bwav"LoadWave/C /P=home "ad1_130.bwav"LoadWave/C /P=home "ad1_131.bwav"LoadWave/C /P=home "ad1_132.bwav"LoadWave/C /P=home "ad1_133.bwav"LoadWave/C /P=home "ad1_134.bwav"LoadWave/C /P=home "ad1_135.bwav"LoadWave/C /P=home "ad1_136.bwav"LoadWave/C /P=home "ad1_137.bwav"LoadWave/C /P=home "ad1_138.bwav"LoadWave/C /P=home "ad1_139.bwav"LoadWave/C /P=home "ad1_140.bwav"LoadWave/C /P=home "ad1_141.bwav"LoadWave/C /P=home "ad1_142.bwav"LoadWave/C /P=home "ad1_143.bwav"LoadWave/C /P=home "ad1_144.bwav"LoadWave/C /P=home "ad1_145.bwav"LoadWave/C /P=home "ad1_146.bwav"LoadWave/C /P=home "ad1_147.bwav"LoadWave/C /P=home "ad1_148.bwav"LoadWave/C /P=home "ad1_149.bwav"LoadWave/C /P=home "ad1_150.bwav"LoadWave/C /P=home "ad1_151.bwav"LoadWave/C /P=home "ad1_152.bwav"LoadWave/C /P=home "ad1_153.bwav"LoadWave/C /P=home "ad1_154.bwav"LoadWave/C /P=home "ad1_155.bwav"LoadWave/C /P=home "ad1_156.bwav"LoadWave/C /P=home "ad1_157.bwav"LoadWave/C /P=home "ad1_158.bwav"LoadWave/C /P=home "ad1_159.bwav"LoadWave/C /P=home "ad1_160.bwav"LoadWave/C /P=home "ad1_161.bwav"LoadWave/C /P=home "ad1_162.bwav"LoadWave/C /P=home "ad1_163.bwav"LoadWave/C /P=home "ad1_164.bwav"LoadWave/C /P=home "ad1_165.bwav"LoadWave/C /P=home "ad1_166.bwav"LoadWave/C /P=home "ad1_167.bwav"LoadWave/C /P=home "ad1_168.bwav"LoadWave/C /P=home "ad1_169.bwav"LoadWave/C /P=home "ad1_170.bwav"LoadWave/C /P=home "ad1_171.bwav"LoadWave/C /P=home "ad1_172.bwav"LoadWave/C /P=home "ad1_173.bwav"LoadWave/C /P=home "ad1_174.bwav"LoadWave/C /P=home "ad1_175.bwav"LoadWave/C /P=home "ad1_176.bwav"LoadWave/C /P=home "ad1_177.bwav"LoadWave/C /P=home "ad1_178.bwav"LoadWave/C /P=home "ad1_179.bwav"LoadWave/C /P=home "ad1_180.bwav"LoadWave/C /P=home "ad1_181.bwav"LoadWave/C /P=home "ad1_182.bwav"LoadWave/C /P=home "ad1_183.bwav"LoadWave/C /P=home "ad1_184.bwav"LoadWave/C /P=home "ad1_185.bwav"LoadWave/C /P=home "ad1_186.bwav"LoadWave/C /P=home "ad1_187.bwav"LoadWave/C /P=home "ad1_188.bwav"LoadWave/C /P=home "ad1_189.bwav"LoadWave/C /P=home "ad1_190.bwav"LoadWave/C /P=home "ad1_191.bwav"LoadWave/C /P=home "ad1_192.bwav"LoadWave/C /P=home "ad1_193.bwav"LoadWave/C /P=home "ad1_194.bwav"LoadWave/C /P=home "ad1_195.bwav"LoadWave/C /P=home "ad1_11d.ibw"LoadWave/C /P=home "crossings.ibw"LoadWave/C /P=home "spikehalfwidth.ibw"LoadWave/C /P=home "tmpwave.ibw"LoadWave/C /P=home "diff_wave.ibw"LoadWave/C /P=home "diff2_wave.ibw"LoadWave/C /P=home "diff3_wave.ibw"LoadWave/C /P=home "spike_number.ibw"LoadWave/C /P=home "threshtime_wave.ibw"LoadWave/C /P=home "threshold_wave.ibw"LoadWave/C /P=home "width_wave.ibw"LoadWave/C /P=home "amp_wave.ibw"LoadWave/C /P=home "peak_wave.ibw"LoadWave/C /P=home "rest_wave.ibw"LoadWave/C /P=home "f_ahp_wave.ibw"LoadWave/C /P=home "f_ahp_raw_wave.ibw"LoadWave/C /P=home "s_ahp_wave.ibw"LoadWave/C /P=home "f_ahp_time_wave.ibw"LoadWave/C /P=home "maxdvdt_wave.ibw"LoadWave/C /P=home "ad1_16d.ibw"LoadWave/C /P=home "ad1_21d.ibw"LoadWave/C /P=home "ad1_24d.ibw"LoadWave/C /P=home "ad1_28d.ibw"NewDataFolder/S PackagesNewPath home ":March2-Module2 Folder:Packages:"SetDataFolder ::NewDataFolder/S Graph2NewPath home ":March2-Module2 Folder:Graph2:"ReadVariablesLoadWave/C /P=home "Injected Current (pA).ibw"LoadWave/C /P=home "Recorded Voltage (mV).ibw"LoadWave/C /P=home "fit_Recorded Voltage (mV).ibw"LoadWave/C /P=home "ad1_50.ibw"LoadWave/C /P=home "crossings.ibw"LoadWave/C /P=home "spikehalfwidth.ibw"SetDataFolder ::NewDataFolder/S Graph1NewPath home ":March2-Module2 Folder:Graph1:"ReadVariablesLoadWave/C /P=home "Avg_ad1_330_339.ibw"LoadWave/C /P=home "Avg_ad1_440_449.ibw"SetDataFolder ::NewPath home ":March2-Module2 Folder:"DefaultFont "Geneva"MoveWindow/P 5,44,505,339TestPulsePanel()ADC_DACcontrol()DataAcqDisplay()TestPulseDisplay()DataPro_Menu()DataPro_Menu0()DataAcqPanel()String/G root:gWMSetNextTextFilesTextEncoding = "macintosh"	// Text encoding for "PhasePlane.ipf". Used by Igor Pro 7.OpenProc/W=(282,246,782,541)/P=student_macros "PhasePlane.ipf"String/G root:gWMSetNextTextFilesTextEncoding = "macintosh"	// Text encoding for "AP_Macros.ipf". Used by Igor Pro 7.OpenProc/W=(285,44,1093,836)/P=igor_procs "AP_Macros.ipf"Graph1()Graph7()Graph8()Graph6()MoveWindow/C 58,847,1168,952Graph0()Graph2()Table0()KillStrings/Z root:gWMSetNextTextFilesTextEncodingWindow Table0() : Table	PauseUpdate; Silent 1		// building window...	Edit/W=(5,44,921,284) spike_number,rest_wave,threshold_wave,threshtime_wave,maxdvdt_wave	AppendToTable amp_wave,peak_wave,width_wave,f_ahp_wave,f_ahp_time_wave	ModifyTable format(Point)=1EndMacroWindow Graph2() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(35,44,382,280) ad1_28EndMacroWindow Graph0() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(64,71,479,274) ad1_11	ModifyGraph tickUnit=1	Label left "dV/dt (mV/ms)"	Label bottom "Vm (mV)"	Cursor/P A ad1_11 953;Cursor/P B ad1_11 1882	ShowInfoEndMacroWindow Graph6() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(88,285,483,493) ad1_16EndMacroWindow Graph8() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(90,748,485,956) ad1_24EndMacroWindow Graph7() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(92,517,487,725) ad1_21EndMacroWindow Graph1() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(35,44,430,252) ad1_11d vs ad1_11EndMacroWindow DataAcqPanel() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(168,45,788,190) as "Data Acquisition Panel"	SetDrawLayer UserBack	DrawLine -2,29,466,29	SetDrawEnv fstyle= 1	DrawText 5,54,"StepPulse_DAC"	DrawLine -1,110,467,110	SetDrawEnv fstyle= 1	DrawText 3,136,"SynPulse_TTL"	DrawLine 475,10,475,140	Button button0,pos={14,5},size={80,20},proc=DataAcqButtonProc,title="Get Data"	CheckBox pn_check,pos={282,35},size={51,15},title="pN sub.",value= 0	SetVariable wavenumber_val,pos={113,7},size={120,15},title="next wave"	SetVariable wavenumber_val,format="%d",limits={0,inf,1},value= wavenumber	CheckBox dpamp_check0,pos={44,61},size={36,15},proc=DPampCheckProc,title="Low"	CheckBox dpamp_check0,value= 0	CheckBox dpamp_check1,pos={44,84},size={37,15},proc=DPampCheckProc,title="High"	CheckBox dpamp_check1,value= 1	CheckBox dpdur_check0,pos={231,62},size={42,15},proc=DPdurCheckProc,title="Short"	CheckBox dpdur_check0,value= 1	CheckBox dpdur_check1,pos={231,84},size={39,15},proc=DPdurCheckProc,title="Long"	CheckBox dpdur_check1,value= 0	SetVariable dpamplow,pos={110,63},size={95,15},proc=DPampProc,title="pulse"	SetVariable dpamplow,limits={-10000,10000,10},value= dplow	SetVariable dpamphigh,pos={110,85},size={95,15},proc=DPampProc,title="pulse"	SetVariable dpamphigh,limits={-10000,10000,10},value= dphigh	SetVariable dpdurshort,pos={296,62},size={120,15},proc=DPdurProc,title="duration"	SetVariable dpdurshort,limits={1,1000,10},value= dpshort	SetVariable dpdurlong,pos={296,85},size={120,15},proc=DPdurProc,title="duration"	SetVariable dpdurlong,limits={1e-05,100000,100},value= dplong	CheckBox syn_check,pos={126,117},size={53,15},proc=SynCheckProc,title="stim. on"	CheckBox syn_check,value= 0	SetVariable syntime,pos={216,119},size={85,15},title="time"	SetVariable syntime,limits={0,1000,10},value= syntime	SetVariable syndur,pos={336,117},size={80,15},title="dur."	SetVariable syndur,limits={0.001,10,0.1},value= syndur	SetVariable setvar1,pos={134,36},size={115,15},title="samp. int."	SetVariable setvar1,limits={0.001,100,0.01},value= sintdp	ValDisplay valdisp0,pos={268,6},size={166,13},title="last sample interval"	ValDisplay valdisp0,limits={0,0,0},barmisc={0,1000},value= #"sint"	SetVariable pN_setvar,pos={366,36},size={70,15},title="pN",value= pn	Button MTR_button0,pos={490,5},size={80,20},proc=MTR_Loop_Acquire,title="Loop Acq"	SetVariable MTR_setvar0,pos={490,36},size={120,15},title="   # of sweeps"	SetVariable MTR_setvar0,limits={1,inf,1},value= NumOfSweeps	SetVariable MTR_setvar1,pos={490,60},size={120,15},title="sweep int. (s)"	SetVariable MTR_setvar1,limits={0,inf,1},value= SweepInterval_s	CheckBox MTR_LoopAverage,pos={525,90},size={52,15},title="average",value= 0	SetWindow kwTopWin,userdata(Package)=  "DataPro"EndMacroWindow DataPro_Menu0() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(1,45,166,505) as "DataPro Main"	ModifyPanel cbRGB=(34816,34816,34816)	SetDrawLayer UserBack	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 13,72,"data acquisition and"	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 13,89,"analysis macros for"	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 11,124,"Instrutech ITC16/18."	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 11,106,"use with Igor Pro &"	SetDrawEnv gstart	SetDrawEnv linefgc= (65535,65535,0),fillfgc= (65535,65535,0)	DrawPoly 49,40,1.38806,1.0303,{28,397,33,390,39,383,45,377,51,373,57,381,60,387,64,394,67,401,73,406,81,405,88,399,91,393,93,387,95,381}	SetDrawEnv fname= "Helvetica",fsize= 36,fstyle= 1,textrgb= (65535,0,0)	DrawText 12,41,"DataPro"	SetDrawEnv gstop	CheckBox Vclamp_check,pos={20,141},size={79,15},proc=ClampModeProc,title="voltage clamp"	CheckBox Vclamp_check,value= 1	CheckBox Cclamp_check,pos={20,171},size={78,15},proc=ClampModeProc,title="current clamp"	CheckBox Cclamp_check,value= 0	Button MClamp_button,pos={16,205},size={120,20},disable=1,proc=MClamp_Button_Ctrl,title="MultiClamp ctrl"	Button ADCDACctrl_button,pos={16,235},size={120,20},proc=ADC_DACButtonProc,title="ADC/DAC control"	Button tp_button,pos={16,265},size={120,20},proc=TPWinButtonProc,title="Test pulse"	Button data_button,pos={16,295},size={120,20},proc=DataButtonProc,title="Acquire"	Button longdata_button,pos={16,325},size={120,20},proc=LongDataButtonProc,title="Long Acquire"	Button pulse_button,pos={16,355},size={120,20},proc=DACBuilderButtonProc,title="DAC Pulse Builder"	Button analyze_button,pos={16,415},size={120,20},proc=AnalysisPanelButtonProc,title="Analyze"EndMacroWindow DataPro_Menu() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(1,45,166,505) as "DataPro Main"	ModifyPanel cbRGB=(34816,34816,34816)	SetDrawLayer UserBack	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 13,72,"data acquisition and"	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 13,89,"analysis macros for"	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 11,124,"Instrutech ITC16/18."	SetDrawEnv fsize= 10,fstyle= 1,textrgb= (65535,65535,0)	DrawText 11,106,"use with Igor Pro &"	SetDrawEnv gstart	SetDrawEnv linefgc= (65535,65535,0),fillfgc= (65535,65535,0)	DrawPoly 49,40,1.38806,1.0303,{28,397,33,390,39,383,45,377,51,373,57,381,60,387,64,394,67,401,73,406,81,405,88,399,91,393,93,387,95,381}	SetDrawEnv fname= "Helvetica",fsize= 36,fstyle= 1,textrgb= (65535,0,0)	DrawText 12,41,"DataPro"	SetDrawEnv gstop	CheckBox Vclamp_check,pos={20,141},size={79,15},proc=ClampModeProc,title="voltage clamp"	CheckBox Vclamp_check,value= 0	CheckBox Cclamp_check,pos={20,171},size={78,15},proc=ClampModeProc,title="current clamp"	CheckBox Cclamp_check,value= 1	Button MClamp_button,pos={16,205},size={120,20},disable=1,proc=MClamp_Button_Ctrl,title="MultiClamp ctrl"	Button ADCDACctrl_button,pos={16,235},size={120,20},proc=ADC_DACButtonProc,title="ADC/DAC control"	Button tp_button,pos={16,265},size={120,20},proc=TPWinButtonProc,title="Test pulse"	Button data_button,pos={16,295},size={120,20},proc=DataButtonProc,title="Acquire"	Button longdata_button,pos={16,325},size={120,20},proc=LongDataButtonProc,title="Long Acquire"	Button pulse_button,pos={16,355},size={120,20},proc=DACBuilderButtonProc,title="DAC Pulse Builder"	Button analyze_button,pos={16,415},size={120,20},proc=AnalysisPanelButtonProc,title="Analyze"	SetWindow kwTopWin,userdata(Package)=  "DataPro"EndMacroWindow TestPulseDisplay() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(789,212,1277,612) TestPulse_ADC as "Test Pulse Display"	ModifyGraph margin(top)=35	ModifyGraph grid(left)=1	Label left "\\F'Helvetica'\\Z12\\f01millivolts"	Label bottom "\\F'Helvetica'\\Z12\\f01milliseconds"	SetAxis left -74.3412445068359,-59.0681259155273	ValDisplay rseal_val,pos={54,4},size={190,21},font="Courier",fSize=20	ValDisplay rseal_val,format="R. %8.4f G½",frame=3	ValDisplay rseal_val,limits={0,0,0},barmisc={0,1000},value= #"rseal"	CheckBox MTR_Checkbox0,pos={251,7},size={61,15},title="Autoscale"	CheckBox MTR_Checkbox0,variable= TestPulse_Autoscale	Button MTR_TPDWriteButton,pos={2,6},size={45,16},proc=TP_WriteResistance,title="Write"	SetDrawLayer UserFront	SetDrawEnv xcoord= rel,ycoord= rel,fillfgc= (52428,52428,52428),fsize= 18	SetDrawEnv save	DrawRect 1,0,0,0.08	SetWindow kwTopWin,userdata(Package)=  "DataPro"EndMacroWindow DataAcqDisplay() : Graph	PauseUpdate; Silent 1		// building window...	Display /W=(161,210,854,676) ad1_195 as "Data Acquisition Display"	ModifyGraph margin(left)=58	ModifyGraph grid(left)=1	ModifyGraph tickUnit=1	Label left "dV/dt (mV/ms)"	Label bottom "Vm (mV)"	SetAxis/A=2 left	ControlBar 50	CheckBox cursor_check,pos={353,23},size={51,15},proc=CursorsCheckProc,title="Cursors"	CheckBox cursor_check,value= 0	SetVariable ymax_set,pos={124,24},size={85,15},proc=ResetAxesProc,title="Top"	SetVariable ymax_set,value= ymax	CheckBox autoscaley_check,pos={225,23},size={69,15},proc=RescaleCheckProc,title="Autoscale y"	CheckBox autoscaley_check,value= 1	CheckBox autoscalex_check,pos={226,4},size={69,15},proc=RescaleCheckProc,title="Autoscale x"	CheckBox autoscalex_check,value= 1	SetVariable ymin_set,pos={4,25},size={100,15},title="Bottom",value= ymin	SetVariable xmin_set,pos={23,3},size={80,15},title="Left",value= xmin	SetVariable xmax_set,pos={115,3},size={95,15},title="Right",value= xmax	ValDisplay valdisp0,pos={340,3},size={90,13},title="Sweep",format="%d"	ValDisplay valdisp0,limits={0,0,0},barmisc={0,1000},value= #"previouswave"	SetWindow kwTopWin,userdata(Package)=  "DataPro"EndMacroWindow ADC_DACcontrol() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(156,703,881,812)	SetDrawLayer UserBack	SetDrawEnv linethick= 2	DrawLine 274,-1,274,105	SetDrawEnv linethick= 2	DrawLine 494,-3,494,105	SetDrawEnv fsize= 10	DrawText 90,84,"Voltage clamp: V/pA"	SetDrawEnv fsize= 10	DrawText 90,99,"Current clamp: V/mV"	SetDrawEnv fsize= 10	DrawText 370,84,"Voltage clamp: mV/V"	SetDrawEnv fsize= 10	DrawText 370,99,"Current clamp: pA/V"	SetDrawEnv fstyle= 1	DrawText 4,89,"Gain units:"	SetDrawEnv fstyle= 1	DrawText 282,90,"Gain units:"	SetVariable dacgainval_0,pos={354,11},size={85,15},proc=ResetGains,title="gain"	SetVariable dacgainval_0,format="%g",limits={0.0001,10000,0},value= dacgain0	SetVariable adcgainval_0,pos={70,13},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_0,format="%g",limits={0.0001,10000,10},value= adcgain0	SetVariable adcgainval_1,pos={70,43},size={85,15},proc=ResetGains,title="gain"	SetVariable adcgainval_1,format="%g",limits={0.0001,10000,10},value= adcgain1	CheckBox adcon_0,pos={10,12},size={43,15},proc=ADCDACcheckProc,title="ADC0"	CheckBox adcon_0,value= 0	CheckBox adcon_1,pos={10,42},size={43,15},proc=ADCDACcheckProc,title="ADC1"	CheckBox adcon_1,value= 1	CheckBox dacon_0,pos={288,10},size={43,15},proc=ADCDACcheckProc,title="DAC0"	CheckBox dacon_0,value= 1	PopupMenu dacpopup_0,pos={287,34},size={116,20}	PopupMenu dacpopup_0,mode=3,popvalue="StepPulse_DAC",value= #"\"_none_;\"+Wavelist(\"*_DAC\",\";\",\"\")"	CheckBox ttlon_0,pos={509,10},size={41,15},proc=ADCDACcheckProc,title="TTL0"	CheckBox ttlon_0,value= 0	PopupMenu ttlpopup_0,pos={585,10},size={70,20}	PopupMenu ttlpopup_0,mode=1,popvalue="_none_",value= #"\"_none_;\"+Wavelist(\"*_TTL\",\";\",\"\")"	SetVariable multdac_0,pos={415,34},size={70,15},title="x "	SetVariable multdac_0,limits={-10000,10000,100},value= multdac0	SetVariable setadcname_0,pos={166,14},size={100,15},proc=SetBaseNameProc	SetVariable setadcname_0,value= adcname0	SetVariable setadcname_1,pos={167,43},size={100,15},proc=SetBaseNameProc	SetVariable setadcname_1,value= adcname1	SetWindow kwTopWin,userdata(Package)=  "DataPro"EndMacroWindow TestPulsePanel() : Panel	PauseUpdate; Silent 1		// building window...	NewPanel /W=(790,45,1278,190) as "Test Pulse Panel"	CheckBox tpamp_check2,pos={13,83},size={50,20},disable=1,proc=TPampCheckProc,title="Gate"	CheckBox tpamp_check2,value= 0	SetVariable tpampgate,pos={71,83},size={95,17},disable=1,proc=TPampProc,title="pulse"	SetVariable tpampgate,fSize=10,limits={-1000,1000,1},value= tpgateamp	Button button0,pos={23,5},size={50,20},proc=TPStartButtonProc,title="Start"	CheckBox bsub0,pos={130,9},size={78,15},title="baseline subt.",value= 0	CheckBox tpamp_check0,pos={13,40},size={36,15},proc=TPampCheckProc,title="Low"	CheckBox tpamp_check0,value= 0	CheckBox tpamp_check1,pos={13,61},size={37,15},proc=TPampCheckProc,title="High"	CheckBox tpamp_check1,value= 1	CheckBox tpdur_check0,pos={193,35},size={42,15},proc=TPdurCheckProc,title="Short"	CheckBox tpdur_check0,value= 0	CheckBox tpdur_check1,pos={193,58},size={39,15},proc=TPdurCheckProc,title="Long"	CheckBox tpdur_check1,value= 1	SetVariable tpamplow,pos={72,39},size={95,16},proc=TPampProc,title="pulse"	SetVariable tpamplow,fSize=10,limits={-1000,1000,1},value= tplow	SetVariable tpamphigh,pos={71,61},size={95,16},proc=TPampProc,title="pulse"	SetVariable tpamphigh,fSize=10,limits={-10000,10000,10},value= tphigh	SetVariable tpdurshort,pos={258,36},size={120,16},proc=TPdurProc,title="duration"	SetVariable tpdurshort,fSize=10,limits={1,1000,1},value= tpshort	SetVariable tpdurlong,pos={258,59},size={120,16},proc=TPdurProc,title="duration"	SetVariable tpdurlong,fSize=10,limits={1,1000,10},value= tplong	SetVariable sinttp_setvar,pos={234,9},size={145,16},title="sample interval"	SetVariable sinttp_setvar,fSize=10,limits={0,100,0.01},value= sinttp	SetVariable test_adc,pos={94,111},size={110,15},proc=TPP_ADC_DAC_SetVar_Control,title="show ADC"	SetVariable test_adc,limits={0,7,1},value= testadc	SetVariable test_dac,pos={239,111},size={100,15},proc=TPP_ADC_DAC_SetVar_Control,title="use DAC"	SetVariable test_dac,limits={0,7,1},value= testdac	Button ADC_DAC_LinkButton,pos={210,110},size={21,17},proc=TPP_ADC_DAC_Link_Button,title=""	Button ADC_DAC_LinkButton,picture= ProcGlobal#Unlinked	SetWindow kwTopWin,userdata(Package)=  "DataPro"EndMacro